---
tags:
  - CTF
  - Criptografía
  - Hacking
  - Software
  - Programación
  - Computación
---
>Problema de la rama de [[Crypto]]
# Descripción
Why use p and q when I can use more? Connect with `nc jupiter.challenges.picoctf.org 3726`.
# Pistas
- There's more prime factors than p and q, finding d is going to be different.
# Solución
Primero nos conectamos al servidor usando [[NET CAT (nc)]]
```bash
AsumomezaC-picoctf@webshell:~$ nc jupiter.challenges.picoctf.org 3726
c: 10446552824224030055034732006241231160293154070000669137287224552259791104213691629766251586699719060325343252060902455608329768187102371180868121362983271390810052033440462515766619560284609768836979551608031122988939975071740403418540466235285738478170735781803509944925851179109405291083701754059485470847141390154989857093025970033686141784
n: 29771010969718869065772527629479278405936043224595874773191477435014247460498916895136805813944906011014996787654592398206522123882761481135991358504445020720638618039275753809793662488966316993695955745960574077924245529495055902701865926520798190462245984314102988014812698714202450285236996265583493165251316940232822615665957979271856734933
e: 65537
```

Con apoyo de una [página](https://www.alpertron.com.ar/ECM.HTM) conseguimos el Euler's totient: 29771010888108892311591104916913450776731372567163864197739553402938391939757582311412407895369897335619713183739438231417436877878867668579507004489088627790433600566062590841360903299982312832042194976986683722904329299074572473317284053826524829267399917058903484518350401316989842102812243857437593524817786418692035200711393280000000000000

Después ejecutamos un script de [[Python]].
```python
c = 10446552824224030055034732006241231160293154070000669137287224552259791104213691629766251586699719060325343252060902455608329768187102371180868121362983271390810052033440462515766619560284609768836979551608031122988939975071740403418540466235285738478170735781803509944925851179109405291083701754059485470847141390154989857093025970033686141784
n = 29771010969718869065772527629479278405936043224595874773191477435014247460498916895136805813944906011014996787654592398206522123882761481135991358504445020720638618039275753809793662488966316993695955745960574077924245529495055902701865926520798190462245984314102988014812698714202450285236996265583493165251316940232822615665957979271856734933
e = 65537
phi=29771010888108892311591104916913450776731372567163864197739553402938391939757582311412407895369897335619713183739438231417436877878867668579507004489088627790433600566062590841360903299982312832042194976986683722904329299074572473317284053826524829267399917058903484518350401316989842102812243857437593524817786418692035200711393280000000000000    
def xgcd(a, b):
    """return (g, x, y) such that a*x + b*y = g = gcd(a, b)"""
    x0, x1, y0, y1 = 0, 1, 1, 0
    while a != 0:
        q, b, a = b // a, a, b % a
        y0, y1 = y1, y0 - q * y1
        x0, x1 = x1, x0 - q * x1
    return b, x0, y0

def mulinv(a, b):
    """return x such that (x * a) % b == 1"""
    g, x, _ = xgcd(a, b)
    if g == 1:
        return x % b

d = mulinv(e, phi)
m = pow(c, d, n)
print(m.to_bytes(m.bit_length(), 'big').replace(b'\x00', b''))
```
Y obtenemos la bandera.
```bash
b'picoCTF{too_many_fact0rs_8606199}'


** Process exited - Return Code: 0 **
Press Enter to exit terminal
```
## Respuesta
picoCTF{too_many_fact0rs_8606199}